<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.parkyangji.openmarket.backend.user.mapper.UserSqlMapper">
  <!-- 회원가입 -->
  <insert id="insertCustomer">
      <!-- MySQL의 경우 LAST_INSERT_ID() 등을 활용 -->
      <selectKey keyProperty="customer_id" resultType="int" order="AFTER">
          SELECT LAST_INSERT_ID()
      </selectKey>
      
      INSERT INTO customer(username, password, nickname, gender, phone)
      VALUES(#{username}, SHA2(concat(#{password}, '!@www'), '256'), #{nickname}, #{gender}, #{phone})
  </insert>
  <insert id="insertAddress">
		INSERT INTO address(customer_id, address)
		VALUES(#{customer_id}, #{address})
  </insert>
  
  <!-- 아이디 비번 -->
	<select id="selectLoginCheck" resultType="com.parkyangji.openmarket.backend.dto.CustomerDto">
		select * from customer c
		where c.username = #{username} and c.password = SHA2(concat(#{password}, '!@www'), '256')
	</select>

  <select id="selectProductDto" resultType="com.parkyangji.openmarket.backend.dto.ProductDto">
    SELECT * FROM product WHERE product_id = #{product_id}
  </select>

  <select id="searchStoreName" resultType="String">
    SELECT store_name FROM seller WHERE seller_id = #{seller_id};
  </select>
</mapper>
